<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Patrimoine UNESCO - Am√©rique du Sud</title>

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <style>
    html, body { height: 100%; margin: 0; }
    #map { width: 100%; height: 100%; }

    .legend {
      padding: 8px 10px;
      background: white;
      border-radius: 10px;
      font-size: 12px;
      line-height: 1.4;
      box-shadow: 0 6px 18px rgba(0,0,0,0.18);
      border: 1px solid rgba(0,0,0,0.08);
    }
    .legend span {
      display: inline-block;
      width: 12px;
      height: 12px;
      margin-right: 6px;
      border-radius: 50%;
      vertical-align: middle;
    }

    /* === JOLI BOUTON SWITCH === */
    .basemap-toggle {
      background: rgba(255,255,255,0.92);
      border: 1px solid rgba(0,0,0,0.12);
      border-radius: 12px;
      padding: 8px;
      box-shadow: 0 8px 22px rgba(0,0,0,0.18);
      backdrop-filter: blur(6px);
    }
    .basemap-toggle button {
      all: unset;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 10px;
      font: 600 13px/1 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: #111;
      background: white;
      border: 1px solid rgba(0,0,0,0.10);
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
      transition: transform .05s ease, box-shadow .2s ease;
      user-select: none;
    }
    .basemap-toggle button:hover {
      box-shadow: 0 6px 16px rgba(0,0,0,0.14);
    }
    .basemap-toggle button:active {
      transform: translateY(1px);
      box-shadow: 0 2px 10px rgba(0,0,0,0.10);
    }
    .basemap-toggle .pill {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: #2ca02c; /* vert = carte */
    }
    .basemap-toggle .sub {
      display: block;
      font-weight: 500;
      opacity: 0.75;
      font-size: 11px;
      margin-top: 2px;
    }
    .basemap-toggle .label-wrap {
      display: flex;
      flex-direction: column;
      gap: 0;
    }
  </style>
</head>

<body>
  <div id="map"></div>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <script>
    // Liste des sites UNESCO (bien mat√©riel) + √©l√©ments immat√©riels
    const sites = [
      // ===== P√âROU =====
      {
        name: "Sanctuaire historique de Machu Picchu",
        country: "P√©rou",
        lat: -13.163068,
        lng: -72.545128,
        category: "mixte",
        unescoType: "Bien mixte (culture + nature)",
        year: 1983,
        description:
          "Site inca embl√©matique dans les Andes, combinant architecture de pierre et paysage montagneux exceptionnel."
      },
      {
        name: "Ville de Cuzco",
        country: "P√©rou",
        lat: -13.52,
        lng: -71.97,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 1983,
        description:
          "Ancienne capitale de l‚Äôempire inca, ville coloniale b√¢tie sur les fondations de la cit√© pr√©hispanique."
      },
      {
        name: "Lignes et g√©oglyphes de Nazca et de Pampas de Jumana",
        country: "P√©rou",
        lat: -14.716667,
        lng: -75.133333,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 1994,
        description:
          "Immenses g√©oglyphes trac√©s dans le d√©sert, repr√©sentant animaux, figures g√©om√©triques et lignes rituelles."
      },

      // ===== √âQUATEUR =====
      {
        name: "√éles Gal√°pagos",
        country: "√âquateur",
        lat: -0.6667,
        lng: -90.55,
        category: "naturel",
        unescoType: "Bien naturel",
        year: 1978,
        description:
          "Archipel volcanique au Pacifique, laboratoire naturel de l‚Äô√©volution c√©l√®bre pour sa faune end√©mique."
      },
      {
        name: "Centre historique de Quito",
        country: "√âquateur",
        lat: -0.180653,
        lng: -78.467838,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 1978,
        description:
          "L‚Äôun des centres coloniaux les mieux pr√©serv√©s d‚ÄôAm√©rique latine, avec de nombreuses √©glises et couvents baroques."
      },

      // ===== ARGENTINE / BR√âSIL (TRANSFRONTALIER) =====
      {
        name: "Parcs nationaux d‚ÄôIguaz√∫ / Igua√ßu",
        country: "Argentine / Br√©sil",
        lat: -25.6953,
        lng: -54.4367,
        category: "naturel",
        unescoType: "Bien naturel (site transfrontalier)",
        year: 1984,
        description:
          "Complexe spectaculaire de chutes d‚Äôeau entour√© de for√™t subtropicale, riche en biodiversit√©."
      },

      // ===== ARGENTINE =====
      {
        name: "Parc national Los Glaciares",
        country: "Argentine",
        lat: -50.0,
        lng: -73.249444,
        category: "naturel",
        unescoType: "Bien naturel",
        year: 1981,
        description:
          "Paysages glaciaires patagoniques, avec notamment le c√©l√®bre glacier Perito Moreno et de vastes champs de glace."
      },
      {
        name: "Cueva de las Manos, R√≠o Pinturas",
        country: "Argentine",
        lat: -47.1558,
        lng: -70.6572,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 1999,
        description:
          "Grotte orn√©e de centaines de silhouettes de mains et de sc√®nes de chasse, t√©moignage tr√®s ancien de l‚Äôart rupestre."
      },

      // ===== BR√âSIL =====
      {
        name: "Centre historique de Salvador de Bahia",
        country: "Br√©sil",
        lat: -12.97399,
        lng: -38.51038,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 1985,
        description:
          "Ancienne capitale coloniale, connue pour ses maisons color√©es, ses √©glises baroques et son h√©ritage afro-br√©silien."
      },
      {
        name: "Bras√≠lia, ensemble urbanistique de Lucio Costa et Oscar Niemeyer",
        country: "Br√©sil",
        lat: -15.793889,
        lng: -47.882778,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 1987,
        description:
          "Capitale moderne planifi√©e, exemple majeur d‚Äôurbanisme du XX·µâ si√®cle et d‚Äôarchitecture monumentale en b√©ton."
      },
      {
        name: "Rio de Janeiro, paysages cariocas entre la montagne et la mer",
        country: "Br√©sil",
        lat: -22.9519,
        lng: -43.2105,
        category: "mixte",
        unescoType: "Bien mixte (paysage culturel)",
        year: 2012,
        description:
          "Paysage culturel associant relief spectaculaire, baie, plages et lieux embl√©matiques comme le Corcovado."
      },

      // ===== CHILI =====
      {
        name: "Quartier historique de la ville portuaire de Valpara√≠so",
        country: "Chili",
        lat: -33.0406,
        lng: -71.6279,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 2003,
        description:
          "Grand port du XIX·µâ si√®cle, avec funiculaires, collines color√©es et architecture li√©e au commerce maritime."
      },
      {
        name: "Parc national de Rapa Nui (√éle de P√¢ques)",
        country: "Chili",
        lat: -27.121192,
        lng: -109.366424,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 1995,
        description:
          "√éle polyn√©sienne isol√©e du Pacifique, c√©l√®bre pour ses moa√Ø monumentaux et ses sites c√©r√©moniels, t√©moignage d‚Äôune civilisation unique."
      },
      {
        name: "√âglises de Chilo√©",
        country: "Chili",
        lat: -42.5,
        lng: -73.76667,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 2000,
        description:
          "Ensemble d‚Äô√©glises en bois, m√©lange d‚Äôarchitecture europ√©enne et de traditions locales de l‚Äôarchipel de Chilo√©."
      },

      // ===== BOLIVIE =====
      {
        name: "Ville de Potos√≠",
        country: "Bolivie",
        lat: -19.58917,
        lng: -65.75333,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 1987,
        description:
          "Ancien centre minier d‚Äôargent du Cerro Rico, symbole de la richesse coloniale espagnole et de son exploitation."
      },
      {
        name: "Tiwanaku : centre spirituel et politique de la culture Tiwanaku",
        country: "Bolivie",
        lat: -16.5536,
        lng: -68.6696,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 2000,
        description:
          "Ruines monumentales d‚Äôune grande civilisation pr√©-inca, pr√®s du lac Titicaca (portes, monolithes, pyramides)."
      },

      // ===== COLOMBIE =====
      {
        name: "Paysage culturel du caf√© de Colombie",
        country: "Colombie",
        lat: 5.47167,
        lng: -75.68167,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 2011,
        description:
          "R√©gion rurale de montagnes et plantations de caf√©, exemple de culture traditionnelle encore vivante."
      },
      {
        name: "Port, forteresses et ensemble monumental de Carthag√®ne des Indes",
        country: "Colombie",
        lat: 10.3997,
        lng: -75.5144,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 1984,
        description:
          "Ville coloniale fortifi√©e cara√Øbe, dot√©e de remparts, bastions et √©difices militaires remarquables."
      },

      // ===== VENEZUELA =====
      {
        name: "Parc national Canaima (Angel Falls, tepuis)",
        country: "Venezuela",
        lat: 5.338,
        lng: -62.0379,
        category: "naturel",
        unescoType: "Bien naturel",
        year: 1994,
        description:
          "Immense parc de savanes et de plateaux rocheux (tepuis), avec notamment le Salto √Ångel, plus haute chute d‚Äôeau du monde."
      },

      // ===== PARAGUAY =====
      {
        name: "Missions j√©suites de La Sant√≠sima Trinidad de Paran√° et Jes√∫s de Tavarangue",
        country: "Paraguay",
        lat: -27.090404,
        lng: -55.730186,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 1993,
        description:
          "Ruines de r√©ductions j√©suites o√π vivaient populations guaranies et missionnaires, exemple marquant d‚Äôurbanisme missionnaire."
      },

      // ===== URUGUAY =====
      {
        name: "Quartier historique de Colonia del Sacramento",
        country: "Uruguay",
        lat: -34.4607,
        lng: -57.8339,
        category: "culturel",
        unescoType: "Bien culturel",
        year: 1995,
        description:
          "Ville coloniale fond√©e par les Portugais face √† Buenos Aires, avec un tissu urbain ancien bien conserv√©."
      },

      // ===== PATRIMOINE IMMAT√âRIEL =====
      {
        name: "Le Tango (patrimoine immat√©riel)",
        country: "Argentine / Uruguay ‚Äì R√≠o de la Plata",
        lat: -34.6037,
        lng: -58.3816,
        category: "immat√©riel",
        unescoType: "Patrimoine culturel immat√©riel de l‚Äôhumanit√©",
        year: 2009,
        description:
          "Musique et danse n√©es dans les quartiers populaires de Buenos Aires et Montevideo, aujourd‚Äôhui symbole du R√≠o de la Plata."
      },
      {
        name: "Samba de Roda du Rec√¥ncavo de Bahia (immat√©riel)",
        country: "Br√©sil",
        lat: -12.94,
        lng: -38.50,
        category: "immat√©riel",
        unescoType: "Patrimoine culturel immat√©riel de l‚Äôhumanit√©",
        year: 2005,
        description:
          "Pratique festive afro-br√©silienne m√™lant musique, chant et danse en cercle, n√©e dans la r√©gion du Rec√¥ncavo de Bahia."
      }
    ];

    // Couleur par cat√©gorie de patrimoine
    function getColor(category) {
      switch (category) {
        case "culturel": return "#1f77b4";
        case "naturel": return "#2ca02c";
        case "mixte": return "#9467bd";
        case "immat√©riel": return "#ff7f0e";
        default: return "#333333";
      }
    }

    // Initialisation carte
    const map = L.map("map", { zoomControl: true }).setView([-15, -60], 3.2);

    // === FONDS DE CARTE ===
    // Carte classique
    const osm = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    });

    // Satellite (vrai)
    const satellite = L.tileLayer(
      "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",
      {
        maxZoom: 19,
        attribution: "Tiles &copy; Esri ‚Äî Source: Esri, Maxar, Earthstar Geographics, and the GIS User Community"
      }
    );

    // Labels au-dessus du satellite (villes/axes/fronti√®res)
    const labels = L.tileLayer(
      "https://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}.png",
      {
        maxZoom: 19,
        attribution: "&copy; OpenStreetMap &copy; CARTO"
      }
    );

    // Fond par d√©faut = carte classique
    osm.addTo(map);

    // √âtat du mode (carte vs satellite)
    let isSatellite = false;

    // === BOUTON SWITCH PROPRE ===
    const ToggleControl = L.Control.extend({
      options: { position: "topright" },
      onAdd: function() {
        const container = L.DomUtil.create("div", "basemap-toggle");
        const btn = L.DomUtil.create("button", "", container);

        btn.innerHTML = `
          <span class="pill" id="modePill"></span>
          <span class="label-wrap">
            <span id="modeTitle">üó∫Ô∏è Carte</span>
            <span class="sub" id="modeSub">Cliquer pour Satellite</span>
          </span>
        `;

        // Emp√™che la carte de bouger quand tu cliques
        L.DomEvent.disableClickPropagation(container);
        L.DomEvent.disableScrollPropagation(container);

        btn.addEventListener("click", () => {
          isSatellite = !isSatellite;

          if (isSatellite) {
            // Passe en satellite + labels
            map.removeLayer(osm);
            satellite.addTo(map);
            labels.addTo(map);

            document.getElementById("modeTitle").textContent = "üõ∞Ô∏è Satellite";
            document.getElementById("modeSub").textContent = "Cliquer pour Carte";
            document.getElementById("modePill").style.background = "#9467bd"; // violet
          } else {
            // Retour carte
            map.removeLayer(satellite);
            map.removeLayer(labels);
            osm.addTo(map);

            document.getElementById("modeTitle").textContent = "üó∫Ô∏è Carte";
            document.getElementById("modeSub").textContent = "Cliquer pour Satellite";
            document.getElementById("modePill").style.background = "#2ca02c"; // vert
          }
        });

        return container;
      }
    });

    map.addControl(new ToggleControl());

    // === MARQUEURS ===
    sites.forEach(site => {
      const color = getColor(site.category);

      const marker = L.circleMarker([site.lat, site.lng], {
        radius: 7,
        color: color,
        weight: 2,
        fillColor: color,
        fillOpacity: 0.7
      });

      const popupHtml = `
        <strong>${site.name}</strong><br/>
        <strong>Pays :</strong> ${site.country}<br/>
        <strong>Type :</strong> ${site.unescoType}<br/>
        <strong>Inscription UNESCO :</strong> ${site.year}<br/>
        <br/>
        ${site.description}
      `;

      marker.bindPopup(popupHtml).addTo(map);
    });

    // L√©gende
    const legend = L.control({ position: "bottomright" });

    legend.onAdd = function () {
      const div = L.DomUtil.create("div", "legend");
      const categories = [
        { key: "culturel", label: "Bien culturel" },
        { key: "naturel", label: "Bien naturel" },
        { key: "mixte", label: "Bien mixte" },
        { key: "immat√©riel", label: "Patrimoine immat√©riel" }
      ];

      div.innerHTML += "<strong>Type de patrimoine</strong><br/>";
      categories.forEach(cat => {
        div.innerHTML +=
          '<span style="background:' + getColor(cat.key) + '"></span>' +
          cat.label + "<br/>";
      });

      return div;
    };

    legend.addTo(map);
  </script>
</body>
</html>
